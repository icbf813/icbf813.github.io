{"link_diff":"https://github.com/apache/commons-compress/compare/ed534048b12afcffd45a53f7b0945f49d929a29a..e860d2f3eb16d84e146a8a700d9dbd3af01df4ba","language":"java","hunk":"diff --git a/src/main/java/org/apache/commons/compress/archivers/zip/Zip64ExtendedInformationExtraField.java b/src/main/java/org/apache/commons/compress/archivers/zip/Zip64ExtendedInformationExtraField.java\nindex 1e0013fdac2..fbcec4843e2 100644\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/Zip64ExtendedInformationExtraField.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/Zip64ExtendedInformationExtraField.java\n@@ -242,7 +242,7 @@ public void parseFromCentralDirectoryData(byte[] buffer, int offset,\n      * field with knowledge which fields are expected to be there.\n      *\n      * <p>All four fields inside the zip64 extended information extra\n-     * field are optional and only present if their corresponding\n+     * field are optional and must only be present if their corresponding\n      * entry inside the central directory contains the correct magic\n      * value.</p>\n      */\n@@ -256,7 +256,7 @@ public void reparseCentralDirectoryData(boolean hasUncompressedSize,\n                 + (hasCompressedSize ? DWORD : 0)\n                 + (hasRelativeHeaderOffset ? DWORD : 0)\n                 + (hasDiskStart ? WORD : 0);\n-            if (rawCentralDirectoryData.length != expectedLength) {\n+            if (rawCentralDirectoryData.length < expectedLength) {\n                 throw new ZipException(\"central directory zip64 extended\"\n                                        + \" information extra field's length\"\n                                        + \" doesn't match central directory\""}
